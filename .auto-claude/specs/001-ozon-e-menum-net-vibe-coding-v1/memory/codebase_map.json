{
  "discovered_files": {
    "package.json": {
      "description": "Next.js 15.5.9 with React 19, TypeScript 5.7, Tailwind CSS 3.4.x, ESLint 8.x setup. Uses App Router with security headers configured in next.config.ts. Vitest configured for testing.",
      "category": "project-setup",
      "discovered_at": "2026-01-13T17:03:50.050963+00:00"
    },
    "supabase/migrations/001_core_tables.sql": {
      "description": "Core tables migration created with organizations (multi-tenant) and organization_members (RBAC). Uses gen_random_uuid() for UUID generation, TIMESTAMPTZ for timestamps, JSONB for settings, CHECK constraint for role enum (owner, admin, manager, waiter, viewer). Includes update_updated_at_column() trigger function reusable by other tables.",
      "category": "database",
      "discovered_at": "2026-01-13T17:11:32.645836+00:00"
    },
    "supabase/migrations/004_tables_service_requests.sql": {
      "description": "Restaurant tables and service requests migration. Uses qr_uuid (not sequential IDs) for QR security. service_requests table designed for Supabase Realtime subscriptions with organization_id index for filtering. Includes spam prevention via last_ping_at column.",
      "category": "database",
      "discovered_at": "2026-01-13T17:16:22.706250+00:00"
    },
    "supabase/migrations/007_rls_policies.sql": {
      "description": "RLS policies for multi-tenant isolation use auth.user_org_ids() helper function to get all organization IDs for current user. All tenant-scoped tables check organization_id IN (SELECT auth.user_org_ids()). price_ledger uses product_id lookup since it doesn't have direct organization_id. Service role key bypasses RLS for public menu pages and system operations.",
      "category": "database",
      "discovered_at": "2026-01-13T17:21:06.208819+00:00"
    },
    "components/ui/index.ts": {
      "description": "Base UI component library with Button (5 variants, 3 sizes), Input/Textarea (with label/error states), Card (with Header/Content/Footer sub-components), Modal (with ConfirmModal variant). All components use forwardRef, proper ARIA attributes, and support dark mode via CSS variables.",
      "category": "architecture",
      "discovered_at": "2026-01-13T17:31:31.199273+00:00"
    },
    "app/api/auth/logout/route.ts": {
      "description": "Logout API route uses POST method with Supabase Auth signOut(). Creates server client with cookie handling pattern from @supabase/ssr. Returns JSON error on failure (500), redirects to home on success. Turkish error messages used for user-facing errors.",
      "category": "auth",
      "discovered_at": "2026-01-13T17:50:25.099895+00:00"
    },
    "components/providers/auth-provider.tsx": {
      "description": "Auth context provider pattern using Supabase auth.onAuthStateChange subscription. Automatically fetches organization membership and details when user signs in. Supports multi-organization users via setCurrentOrganization. useAuth hook in hooks/useAuth.ts provides typed access to context with error on missing provider.",
      "category": "pattern",
      "discovered_at": "2026-01-13T17:52:17.993527+00:00"
    },
    "lib/guards/__tests__/permission.test.ts": {
      "description": "Permission guard unit tests with 27 comprehensive tests covering all exported functions from permission.ts. Uses mocked Supabase client with custom createMockQueryBuilder factory. Tests verify dynamic feature flagging pattern (no hard-coded plan checks), override precedence, limit handling (including unlimited plans with -1), and edge cases. vitest.config.ts updated to include tests from lib/**/__tests__/.",
      "category": "testing",
      "discovered_at": "2026-01-13T18:09:06.425763+00:00"
    },
    "lib/services/price-ledger.ts": {
      "description": "Price ledger service implementing INSERT-only immutable pattern for Turkish Trade Ministry compliance. Uses current_prices database view for latest price retrieval. Key functions: addPriceEntry() (INSERT only), getCurrentPrice(), getPriceHistory(). Exports exportPriceLedgerForCompliance() for regulatory reporting. All operations use createServerSupabaseClient and follow existing guard patterns.",
      "category": "service",
      "discovered_at": "2026-01-13T18:11:24.466279+00:00"
    },
    "lib/__tests__/price-ledger-immutability.test.ts": {
      "description": "Comprehensive unit tests for price ledger immutability pattern (30 tests). Tests verify INSERT-only ledger pattern for Turkish Trade Ministry compliance. Uses mocked Supabase client with custom createMockQueryBuilder factory that properly handles .insert().select().single() chain. Covers: INSERT operations, UPDATE/DELETE blocking verification, current price view, price history queries with pagination, input validation, price statistics, and compliance export functionality.",
      "category": "testing",
      "discovered_at": "2026-01-13T18:17:02.977382+00:00"
    },
    "app/(dashboard)/layout.tsx": {
      "description": "Dashboard layout with sidebar navigation - uses useAuth hook for organization/user info, mobile-responsive with hamburger menu, includes all navigation routes (Dashboard, Categories, Products, Tables, Waiter, Audit, Settings)",
      "category": "component",
      "discovered_at": "2026-01-13T18:23:42.679846+00:00"
    },
    "app/(dashboard)/products/page.tsx": {
      "description": "Products list page with CRUD - displays products with current prices from view, supports search/category filtering, modal forms for add/edit, price changes go to immutable price_ledger, visibility toggle, Turkish UI",
      "category": "dashboard",
      "discovered_at": "2026-01-13T18:27:43.683824+00:00"
    }
  },
  "last_updated": "2026-01-13T18:27:43.683832+00:00"
}